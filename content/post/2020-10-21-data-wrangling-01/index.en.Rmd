---
title: Data Wrangling_01
author: Saurav Das
date: '2020-10-21'
slug: data-wrangling-01
categories:
  - R
tags:
  - R
  - Tutorial
---

#Data Wrangling 

```{r message=FALSE}
library(dplyr)
library(plyr)
```

####Data transformation/wrangling is one of the most important process in visualization and statistical analysis.

So here we will use two functions from apply family. one is **aggregate** and one is **ddply**

The story is like, my friend was asking to plot some simple bar graphs based on his anova results (he is doing works how different rates of nitrogen can effect winter wheat yield and protein content and the experiment is replicated over four different places and four times (same treatment) in single location). He found interactions between some variables (like Nrate and Variety; Nrate and Application timings) and  he wanted to do average over interactive variables and doing mean/error calculations over the replication keeping different rates/var as unique factors and plot them in simple bars using different variables as aesthetics, but it was too much struggling for me to group/subset over multiple variables and then summarize the data over some other functions. I have to go through writing several custom functions. But then I stumbled upon these functions, they are pretty handy and everything can be done in one single steps.


So, I cannot use that datasets what I used, but here is a similar dataset (CO2) where,
The CO2 uptake of six plants from Quebec and six plants from Mississippi was measured at several levels of ambient CO2 concentration. Half the plants of each type were chilled overnight before the experiment was conducted and half were non-chilled. 

So data structure is two location, two different treatment for each location (chilled, non-chilled), then each of the treated plant were exposed to seven different concentration of carbon dioxided and their uptake was measured and above all each plant has unique id.


Lets load the data

```{r}
data("CO2")
head(CO2)
```

So, first we will use **aggregate** function

###aggregate(formula,data, function,... related arguments)###

where formula is y ~ x
y = numerical varibale to be divided 
x = variable to be grouped over

then data = data 
function = whatever function you want to use like mean, median, sd etc.

Lets say we want to summarize the data as mean over the uptake and grouped over concentration of CO2.

```{r}
aggregate(uptake~conc, CO2, mean) 
```

Again say, you want to subset over conc and treatment so, now we will rewrite the code as
**note: you can also use tapply for this function but tapply cannot handle multiple variables for grouping**

```{r}
aggregate(uptake ~ conc + Treatment, CO2, mean)
```

Now, lets say you want to summarize the data for multiple functions, but you end up with errors,

```{r}
aggregate(uptake ~ conc + Treatment, CO2,summarise,mean = mean(uptake), sd = sd(uptake))
```

So, here we will use **ddply** from plyr package. ddply function looks like this,


ddply(
  .data,
  .variables,
  .fun = NULL,
  ...,
  .progress = "none",
  .inform = FALSE,
  .drop = TRUE,
  .parallel = FALSE,
  .paropts = NULL
)

it can be used to summarize the result and results returns as a data_frame

```{r}
#so in .data will be our data and in variables will the variables over which grouping will happen, then .fun will be your function then ... mean addition arguments over your function like
ddply(CO2, c("Treatment", "conc"), summarise, mean = mean(uptake), sd = sd(uptake))
```

--
